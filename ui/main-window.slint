import { GameWindow, TileData } from "app-window.slint";

export enum Page {
    home,
    game,
}



component HomePage inherits Rectangle {
    callback start_game();
    callback open_github();

    background: #f7f4ed;

    Rectangle {
        width: 100%;
        height: 100%;

        // å¤´åƒåŒºåŸŸ (å³ä¸Šè§’)
        Rectangle {
            x: parent.width - 155px;
            y: 20px;
            width: 125px;
            height: 125px;
            clip: true;
            border-radius: 62.5px;
            background: white;

            Image {
                source: @image-url("icons/avatar.svg");
                width: 125px;
                height: 125px;
            }
        }

        // ä»‹ç»æ–‡å­—åŒºåŸŸ (å·¦ä¾§ï¼Œå¤´åƒä¸‹æ–¹)
        Rectangle {
            x: 40px;
            y: 180px;
            width: parent.width - 120px;
            height: 280px;

            VerticalLayout {
                padding: 0px;
                spacing: 12px;
                
                Text {
                    text: "Hi, folks, I'm Chaolun.";
                    font-size: 18px;
                    color: #000000;
                    horizontal-alignment: left;
                    wrap: word-wrap;
                }
                
                Text {
                    text: "I live in Shenzhen and work as an Software Engineer ğŸ‘¨â€ğŸ’».";
                    font-size: 18px;
                    color: #000000;
                    horizontal-alignment: left;
                    wrap: word-wrap;
                }
                
                Text {
                    text: "I am also a Gamer.";
                    font-size: 18px;
                    color: #000000;
                    horizontal-alignment: left;
                    wrap: word-wrap;
                }
                
                Text {
                    text: "Here are some projects I have made.";
                    font-size: 18px;
                    color: #000000;
                    horizontal-alignment: left;
                    wrap: word-wrap;
                }
            }
        }

        // ç¤¾äº¤å›¾æ ‡åŒºåŸŸ (å³ä¸‹è§’)
        Rectangle {
            x: parent.width - 200px;
            y: parent.height - 50px;
            width: 180px;
            height: 40px;

            // GitHub å›¾æ ‡
            Rectangle {
                x: 0;
                y: 0;
                width: 40px;
                height: 40px;
                background: transparent;

                Image {
                    source: @image-url("icons/github.svg");
                    width: 25px;
                    height: 25px;
                    horizontal-alignment: center;
                    vertical-alignment: center;
                }

                TouchArea {
                    clicked => {
                        root.open_github();
                    }
                }
            }

            // Game å›¾æ ‡
            Rectangle {
                x: 60px;
                y: 0;
                width: 40px;
                height: 40px;
                background: transparent;

                Image {
                    source: @image-url("icons/game.svg");
                    width: 25px;
                    height: 25px;
                    horizontal-alignment: center;
                    vertical-alignment: center;
                }

                TouchArea {
                    clicked => {
                        root.start_game();
                    }
                }
            }
        }
    }
}

export component MainWindow inherits Window {
    preferred-width: 400px;
    preferred-height: 600px;
    min-width: 320px;
    min-height: 500px;
    title: "Always Blue - Ocean World";

    in-out property <Page> current_page: Page.home;

    // æ¸¸æˆç›¸å…³çš„å±æ€§å’Œå›è°ƒ
    callback check_if_pair_solved();
    in property <bool> disable_tiles;
    in-out property <[TileData]> memory_tiles;

    if current_page == Page.home: HomePage {
        start_game => {
            root.current_page = Page.game;
            root.start_background_music();
        }
        open_github => {
            // åœ¨ç½‘é¡µç¯å¢ƒä¸­æ‰“å¼€ GitHub é“¾æ¥
            // è¿™ä¸ªå›è°ƒå°†åœ¨ Rust ä»£ç ä¸­å¤„ç†
            root.open_github_page();
        }
    }

    if current_page == Page.game: GameWindow {
        width: root.width;
        height: root.height;
        disable_tiles: root.disable_tiles;
        memory_tiles: root.memory_tiles;

        check_if_pair_solved => {
            root.check_if_pair_solved();
        }

        play_match_sound => {
            root.play_match_sound();
        }

        // æ·»åŠ è¿”å›æŒ‰é’®
        Rectangle {
            x: 10px;
            y: 10px;
            width: 80px;
            height: 35px;
            background: #34495E;
            border-radius: 5px;
            z: 1000;

            Text {
                text: "â† Back";
                color: white;
                font-size: 14px;
                horizontal-alignment: center;
                vertical-alignment: center;
            }

            TouchArea {
                clicked => {
                    root.current_page = Page.home;
                    root.stop_background_music();
                }
            }
        }
    }

    // GitHub é¡µé¢æ‰“å¼€å›è°ƒ
    callback open_github_page();

    // éŸ³é¢‘å›è°ƒ
    callback start_background_music();
    callback stop_background_music();
    callback play_match_sound();
}
